üëë Replit Master Prompt: Multi-Modal Quantitative AI Trading SystemProject Goal: Upgrade the existing trading application into a sophisticated, multi-modal AI trading system ($\approx 5$-minute interval predictions) for Stocks, Crypto, and Forex that prioritizes high Directional Accuracy and robust Walk-Forward Validation. The application must be deployed as an "always-on" background worker and include a Streamlit/Dash monitoring dashboard.I. ‚öôÔ∏è Application Architecture & SetupComponentRequirementTechnology/ConstraintBackend/Core LogicHigh-performance, multi-threaded worker to handle data ingestion and model inference.Python 3.10+ (main.py), use FastAPI for internal signal API endpoint.Frontend/DashboardLive monitoring of signals, performance metrics, and data visualization.Streamlit (simplest deployment) or Plotly Dash.Data PersistenceSecure, scalable storage for historical data and model outputs.PostgreSQL (managed by Replit Database) or InfluxDB (for time-series optimization).DeploymentMust be deployed as a Background Worker to run the trading logic 24/7.Replit Deployments: Reserved VM (for stability).II. üíæ Data Pipeline and Feature Engineering (The Multi-Modal Input)The system must fuse four distinct data modalities into a single input feature set for the model.Price & Technical Data (Core)Sources: Integrate with a real-time financial API (e.g., yfinance for basic, or a more robust paid API via Replit Secrets).Features: OHLCV data, Lagged Prices, and key indicators: RSI, MACD, Multiple EMAs (9, 20, 50), and ATR (Volatility).Sentiment Data (NLP)Sources: Simulate sentiment data retrieval from an external news/social media API (use dummy data or a simple requests call to a public sentiment endpoint initially).Features: Sentiment Score (-1.0 to +1.0) and Sentiment Velocity (change in score over the last hour) as time-series features.Institutional Flow/On-Chain Data (Block Trades)Sources: Use a simple proxy data feed for Dark Pool Volume Ratio (Stocks) or Net Exchange Flow (Crypto).Features: Normalized Daily Institutional Volume and Unusual Block Trade Flag (boolean).Macro/Emotional Data:Features: Ingest and normalize the Fear & Greed Index value as a daily macro-feature input to the model's prediction sequence.III. üß† Core AI Modeling and TrainingThe model must be built to handle the complex, high-dimensional input features.Model Architecture: Implement a Transformer Encoder model (using PyTorch/TensorFlow with libraries like TSLib or custom nn.TransformerEncoder for time series).Reasoning: Chosen for its Self-Attention Mechanism to capture complex, long-range dependencies across all multi-modal features.Input Shape: $(BatchSize, SeqLength, NumFeatures)$, where $NumFeatures \approx 20+$.Target Output: Classification (Directional Prediction): A probability vector of length 3: [P(UP), P(DOWN), P(FLAT)].Training Method: Utilize Walk-Forward Validation (a chronological train-test split) within the training script to simulate real-world, forward-testing.Metrics: Prioritize training to maximize Directional Accuracy (DACC) on the validation set.IV. üß™ Execution, Validation, and Risk ManagementBacktesting Module: Implement a Backtrader or VectorBT component to execute and evaluate the model's Classification signals against historical data.Performance Metrics: Calculate and display: Sharpe Ratio, Max Drawdown, and Total Return on the dashboard.Risk Management (Hard-Coded Layer): The final trading signal must pass through a strict risk layer:If Prediction Confidence $< 70\%$ $\implies$ Signal is HOLD.If Max Daily Drawdown $> 2\%$ $\implies$ Signal is HOLD (or close all open positions).Please scaffold the Python project structure, focusing on the data ingestion and the basic Transformer model architecture, and ensure the deployment configuration is set for a persistent background worker.